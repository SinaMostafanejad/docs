---
title: Experiments limits and performance
description: 제안된 범위 내에서 로깅하여 W&B에서 페이지를 더 빠르고 응답성 좋게 유지하세요.
menu:
  default:
    identifier: ko-guides-models-track-limits
    parent: experiments
weight: 7
---

다음 제안된 범위 내에서 로그를 기록하여 W&B 페이지를 더 빠르고 응답성이 좋게 유지하십시오.

## 기록된 메트릭

`wandb.log` 를 사용하여 실험 메트릭을 추적합니다. 일단 기록되면 이러한 메트릭은 차트를 생성하고 테이블에 표시됩니다. 너무 많은 데이터를 기록하면 앱 속도가 느려질 수 있습니다.

### 고유한 메트릭 수

더 빠른 성능을 위해 프로젝트의 총 고유 메트릭 수를 10,000개 미만으로 유지하십시오.

```python
import wandb

wandb.log(
    {
        "a": 1,  # "a"는 고유한 메트릭입니다
        "b": {
            "c": "hello",  # "b.c"는 고유한 메트릭입니다
            "d": [1, 2, 3],  # "b.d"는 고유한 메트릭입니다
        },
    }
)
```

{{% alert %}}
W&B는 중첩된 값을 자동으로 평면화합니다. 즉, 사전을 전달하면 W&B는 이를 점으로 구분된 이름으로 바꿉니다. config 값의 경우 W&B는 이름에 점 3개를 지원합니다. 요약 값의 경우 W&B는 점 4개를 지원합니다.
{{% /alert %}}

워크스페이스 속도가 갑자기 느려지면 최근의 Runs에서 의도치 않게 수천 개의 새로운 메트릭을 기록했는지 확인하십시오. (이는 수천 개의 플롯이 있는 섹션에 하나 또는 두 개의 Runs만 표시되는 것을 보면 가장 쉽게 알 수 있습니다.) 그렇다면 해당 Runs를 삭제하고 원하는 메트릭으로 다시 만드는 것을 고려하십시오.

### 값 너비

단일 로그 값의 크기를 1MB 미만으로, 단일 `wandb.log` 호출의 총 크기를 25MB 미만으로 제한합니다. 이 제한은 `wandb.Image`, `wandb.Audio` 등과 같은 `wandb.Media` 유형에는 적용되지 않습니다.

```python
# ❌ 권장하지 않음
wandb.log({"wide_key": range(10000000)})

# ❌ 권장하지 않음
with f as open("large_file.json", "r"):
    large_data = json.load(f)
    wandb.log(large_data)
```

넓은 값은 넓은 값을 가진 메트릭뿐만 아니라 Run의 모든 메트릭에 대한 플롯 로드 시간에 영향을 줄 수 있습니다.

{{% alert %}}
권장량보다 넓은 값을 기록하더라도 데이터는 저장되고 추적됩니다. 그러나 플롯 로드 속도가 더 느려질 수 있습니다.
{{% /alert %}}

### 메트릭 빈도

기록하는 메트릭에 적합한 로깅 빈도를 선택하십시오. 일반적인 경험 법칙으로, 메트릭이 넓을수록 로깅 빈도를 줄여야 합니다. W&B는 다음을 권장합니다.

- 스칼라: 메트릭당 \<100,000개의 기록된 포인트
- 미디어: 메트릭당 \<50,000개의 기록된 포인트
- 히스토그램: 메트릭당 \<10,000개의 기록된 포인트

```python
# 총 1백만 단계의 트레이닝 루프
for step in range(1000000):
    # ❌ 권장하지 않음
    wandb.log(
        {
            "scalar": step,  # 100,000개의 스칼라
            "media": wandb.Image(...),  # 100,000개의 이미지
            "histogram": wandb.Histogram(...),  # 100,000개의 히스토그램
        }
    )

    # ✅ 권장
    if step % 1000 == 0:
        wandb.log(
            {
                "histogram": wandb.Histogram(...),  # 10,000개의 히스토그램
            },
            commit=False,
        )
    if step % 200 == 0:
        wandb.log(
            {
                "media": wandb.Image(...),  # 50,000개의 이미지
            },
            commit=False,
        )
    if step % 100 == 0:
        wandb.log(
            {
                "scalar": step,  # 100,000개의 스칼라
            },
            commit=True,
        )  # 일괄 처리된 단계별 메트릭을 함께 커밋합니다
```

{{% alert %}}
W&B는 계속해서 기록된 데이터를 수락하지만, 지침을 초과하면 페이지 로드 속도가 더 느려질 수 있습니다.
{{% /alert %}}

### Config 크기

Run config의 총 크기를 10MB 미만으로 제한합니다. 큰 값을 기록하면 프로젝트 워크스페이스 및 Runs 테이블 작업 속도가 느려질 수 있습니다.

```python
# ✅ 권장
wandb.init(
    config={
        "lr": 0.1,
        "batch_size": 32,
        "epochs": 4,
    }
)

# ❌ 권장하지 않음
wandb.init(
    config={
        "steps": range(10000000),
    }
)

# ❌ 권장하지 않음
with f as open("large_config.json", "r"):
    large_config = json.load(f)
    wandb.init(config=large_config)
```

### Run 횟수

더 빠른 로딩 시간을 위해 단일 프로젝트의 총 Run 횟수를 10,000개 미만으로 유지하십시오. Run 횟수가 많으면 프로젝트 워크스페이스 및 Runs 테이블 작업 속도가 느려질 수 있으며, 특히 그룹화가 활성화되어 있거나 Runs에 고유한 메트릭 수가 많은 경우에 그렇습니다.

자신이나 팀이 동일한 Run 세트 (예: 최근 Run)에 자주 엑세스하는 경우 [다른 Run을 대량으로 이동]({{< relref path="/guides/models/track/runs/manage-runs.md" lang="ko" >}})하여 아카이브로 사용되는 새 프로젝트로 이동하고 작업 프로젝트에 더 작은 Run 세트를 남겨두는 것을 고려하십시오.

### 섹션 수

워크스페이스에 수백 개의 섹션이 있으면 성능이 저하될 수 있습니다. 메트릭의 상위 수준 그룹화를 기반으로 섹션을 만들고 각 메트릭에 대해 하나의 섹션을 만드는 안티 패턴을 피하십시오.

섹션이 너무 많고 성능이 느린 경우 접미사 대신 접두사로 섹션을 만드는 워크스페이스 설정을 고려하십시오. 이렇게 하면 섹션 수가 줄어들고 성능이 향상될 수 있습니다.

{{< img src="/images/track/section_prefix_toggle.gif" alt="섹션 생성 전환" >}}

### 파일 수

단일 Run에 대해 업로드된 총 파일 수를 1,000개 미만으로 유지하십시오. 많은 파일을 기록해야 하는 경우 W&B Artifacts를 사용할 수 있습니다. 단일 Run에서 1,000개가 넘는 파일이 있으면 Run 페이지 속도가 느려질 수 있습니다.

## Python 스크립트 성능

Python 스크립트의 성능이 저하되는 몇 가지 방법이 있습니다.

1. 데이터 크기가 너무 큽니다. 큰 데이터 크기는 트레이닝 루프에 1ms 이상의 오버헤드를 유발할 수 있습니다.
2. 네트워크 속도와 W&B 백엔드 구성 방법
3. `wandb.log` 를 초당 몇 번 이상 호출합니다. 이는 `wandb.log` 가 호출될 때마다 트레이닝 루프에 작은 지연 시간이 추가되기 때문입니다.

{{% alert %}}
잦은 로깅으로 인해 트레이닝 Run 속도가 느려지고 있습니까? 로깅 전략을 변경하여 더 나은 성능을 얻는 방법에 대한 [이 Colab] (http://wandb.me/log-hf-colab)을 확인하십시오.
{{% /alert %}}

W&B는 속도 제한 외에는 어떤 제한도 주장하지 않습니다. W&B Python SDK는 제한을 초과하는 요청에 대해 자동으로 지수 "백오프" 및 "재시도"를 완료합니다. W&B Python SDK는 커맨드라인에서 "네트워크 오류"로 응답합니다. 유료 계정이 아닌 경우 W&B는 사용량이 합리적인 임계값을 초과하는 극단적인 경우에 연락할 수 있습니다.

## 속도 제한

W&B SaaS Cloud API는 시스템 무결성을 유지하고 가용성을 보장하기 위해 속도 제한을 구현합니다. 이 측정은 공유 인프라에서 사용 가능한 리소스를 단일 사용자가 독점하는 것을 방지하여 모든 사용자가 서비스에 엑세스할 수 있도록 보장합니다. 다양한 이유로 더 낮은 속도 제한이 발생할 수 있습니다.

{{% alert %}}
속도 제한은 변경될 수 있습니다.
{{% /alert %}}

### 속도 제한 HTTP 헤더

이전 표에서는 속도 제한 HTTP 헤더에 대해 설명합니다.

| 헤더 이름         | 설명                                                                             |
| ------------------- | --------------------------------------------------------------------------------------- |
| RateLimit-Limit     | 시간 창당 사용 가능한 할당량 (0에서 1000 범위로 조정)                                                                            |
| RateLimit-Remaining | 현재 속도 제한 창의 할당량 (0에서 1000 범위로 조정)                                |
| RateLimit-Reset     | 현재 할당량이 재설정될 때까지의 시간 (초)                                  |

### 메트릭 로깅 API에 대한 속도 제한

스크립트의 `wandb.log` 호출은 메트릭 로깅 API를 활용하여 트레이닝 데이터를 W&B에 기록합니다. 이 API는 온라인 또는 [오프라인 동기화]({{< relref path="/ref/cli/wandb-sync.md" lang="ko" >}})를 통해 사용됩니다. 두 경우 모두 롤링 시간 창에서 속도 제한 할당량 제한을 부과합니다. 여기에는 총 요청 크기 및 요청 속도에 대한 제한이 포함되며, 후자는 시간 기간 내의 요청 수를 나타냅니다.

W&B는 W&B 프로젝트별로 속도 제한을 적용합니다. 따라서 팀에 3개의 프로젝트가 있는 경우 각 프로젝트에는 자체 속도 제한 할당량이 있습니다. [Teams 및 Enterprise 플랜](https://wandb.ai/site/pricing)의 사용자는 Free 플랜의 사용자보다 높은 속도 제한을 갖습니다.

메트릭 로깅 API를 사용하는 동안 속도 제한에 도달하면 표준 출력에서 오류를 나타내는 관련 메시지가 표시됩니다.

### 메트릭 로깅 API 속도 제한을 초과하지 않기 위한 제안

속도 제한을 초과하면 속도 제한이 재설정될 때까지 `run.finish()` 가 지연될 수 있습니다. 이를 방지하려면 다음 전략을 고려하십시오.

- W&B Python SDK 버전 업데이트: 최신 버전의 W&B Python SDK를 사용하고 있는지 확인하십시오. W&B Python SDK는 정기적으로 업데이트되며 요청을 정상적으로 재시도하고 할당량 사용을 최적화하기 위한 향상된 메커니즘이 포함되어 있습니다.
- 메트릭 로깅 빈도 줄이기: 할당량을 보존하기 위해 메트릭 로깅 빈도를 최소화합니다. 예를 들어, 에포크마다 메트릭을 기록하는 대신 5개의 에포크마다 메트릭을 기록하도록 코드를 수정할 수 있습니다.

```python
if epoch % 5 == 0:  # 5개의 에포크마다 메트릭을 기록합니다
    wandb.log({"acc": accuracy, "loss": loss})
```

- 수동 데이터 동기화: 속도 제한이 있는 경우 W&B는 Run 데이터를 로컬에 저장합니다. `wandb sync <run-file-path>` 커맨드를 사용하여 데이터를 수동으로 동기화할 수 있습니다. 자세한 내용은 [`wandb sync`]({{< relref path="/ref/cli/wandb-sync.md" lang="ko" >}}) 레퍼런스를 참조하십시오.

### GraphQL API에 대한 속도 제한

W&B Models UI 및 SDK의 [퍼블릭 API](https://docs.wandb.ai/ref/python/public-api/api)는 데이터를 쿼리하고 수정하기 위해 서버에 GraphQL 요청을 합니다. SaaS Cloud의 모든 GraphQL 요청에 대해 W&B는 권한이 없는 요청에 대해 IP 어드레스별로, 권한이 있는 요청에 대해 사용자별로 속도 제한을 적용합니다. 제한은 고정된 시간 창 내의 요청 속도 (초당 요청)를 기준으로 하며, 가격 책정 플랜에 따라 기본 제한이 결정됩니다. 프로젝트 경로 (예: 리포트, Runs, Artifacts)를 지정하는 관련 SDK 요청의 경우 W&B는 데이터베이스 쿼리 시간으로 측정되는 프로젝트별로 속도 제한을 적용합니다.

[Teams 및 Enterprise 플랜](https://wandb.ai/site/pricing)의 사용자는 Free 플랜의 사용자보다 높은 속도 제한을 받습니다.
W&B Models SDK의 퍼블릭 API를 사용하는 동안 속도 제한에 도달하면 표준 출력에서 오류를 나타내는 관련 메시지가 표시됩니다.

### GraphQL API 속도 제한을 초과하지 않기 위한 제안

W&B Models SDK의 [퍼블릭 API](https://docs.wandb.ai/ref/python/public-api/api)를 사용하여 많은 양의 데이터를 가져오는 경우 요청 사이에 최소 1초 이상 기다리는 것이 좋습니다. 응답 헤더에서 `429` 상태 코드를 받거나 `RateLimit-Remaining=0` 이 표시되면 `RateLimit-Reset` 에 지정된 초 수만큼 기다린 후 다시 시도하십시오.

## 브라우저 고려 사항

W&B 앱은 메모리를 많이 사용하며 Chrome에서 가장 잘 작동합니다. 컴퓨터의 메모리에 따라 W&B가 3개 이상의 탭에서 동시에 활성화되면 성능이 저하될 수 있습니다. 예기치 않게 성능이 느려지면 다른 탭이나 애플리케이션을 닫는 것이 좋습니다.

## W&B에 성능 문제 보고

W&B는 성능을 중요하게 생각하고 지연에 대한 모든 리포트를 조사합니다. 조사를 신속하게 처리하기 위해 로딩 시간이 느린 경우 키 메트릭 및 성능 이벤트를 캡처하는 W&B의 내장 성능 로거를 호출하는 것을 고려하십시오. URL에 &PERF_LOGGING을 추가하고 콘솔 출력을 공유하십시오.

{{< img src="/images/track/adding_perf_logging.gif" alt="PERF_LOGGING 추가" >}}
