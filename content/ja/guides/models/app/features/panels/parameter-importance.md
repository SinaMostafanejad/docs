---
title: Parameter importance
description: モデルのハイパーパラメーターと出力メトリクスの関係を可視化する
menu:
  default:
    identifier: ja-guides-models-app-features-panels-parameter-importance
    parent: panels
weight: 60
---

あなたのハイパーパラメーターが、メトリクスの望ましい値を予測する上でどれが最も優れており、高い相関があったかを発見します。

{{< img src="/images/general/parameter-importance-1.png" alt="" >}}

**相関**とは、ハイパーパラメーターと選択したメトリクス (この場合は val_loss) との線形相関のことです。したがって相関が高いということは、ハイパーパラメーターの値が高いときにメトリクスも高くなり、その逆もまた然りということを意味します。相関は確認する価値のある優れたメトリクスですが、入力間の二次的な相互作用を捉えることはできず、著しく異なる範囲の入力を比較するのが難しくなる場合があります。

このため、W&B は **重要性** メトリクスも計算します。W&B はハイパーパラメーターを入力として、メトリクスを目標出力としてランダムフォレストをトレーニングし、ランダムフォレストの特徴重要度の値をレポートします。

この手法のアイデアは、ランダムフォレストの特徴重要度を利用してハイパーパラメータースペースを探索することを先駆けた [Jeremy Howard](https://twitter.com/jeremyphoward) との会話からインスピレーションを受けたものです。W&B は、この分析の背後にある動機を学ぶために、この[講義](http://course18.fast.ai/lessonsml1/lesson4.html) (およびこれらの[ノート](https://forums.fast.ai/t/wiki-lesson-thread-lesson-4/7540)) をぜひご覧になることを強くお勧めします。

ハイパーパラメータの重要性パネルは、高度に相関したハイパーパラメーター間の複雑な相互作用を解明します。それによって、モデルのパフォーマンスを予測する上で最も重要なハイパーパラメーターを示すことにより、ハイパーパラメーターの探索を微調整するのに役立ちます。

## ハイパーパラメーターの重要性パネルを作成する

1. W&B のプロジェクトに移動します。
2. **Add panels** ボタンを選択します。
3. **CHARTS** ドロップダウンを展開し、ドロップダウンから **Parallel coordinates** を選択します。

{{% alert %}}
空のパネルが表示された場合は、Runs がグループ化されていないことを確認してください。
{{% /alert %}}

{{< img src="/images/app_ui/hyperparameter_importance_panel.gif" alt="Using automatic parameter visualization" >}}

パラメーターマネージャーを使用して、表示するパラメーターと非表示のパラメーターを手動で設定できます。

{{< img src="/images/app_ui/hyperparameter_importance_panel_manual.gif" alt="Manually setting the visible and hidden fields" >}}

## ハイパーパラメーター重要性パネルを解釈する

{{< img src="/images/general/parameter-importance-4.png" alt="" >}}

このパネルには、トレーニングスクリプト内の [wandb.config]({{< relref path="/guides/models/track/config/" lang="ja" >}}) オブジェクトに渡されたすべてのパラメーターが表示されます。次に、これらの config パラメータと選択したモデルメトリクス (`val_loss` この場合) の特徴重要度と相関を示します。

### 重要性

重要性の列は、選択されたメトリクスを予測する上で各ハイパーパラメーターがどの程度有用であったかを示します。多数のハイパーパラメーターのチューニングを始め、このプロットを使用してどれをさらに探索する価値があるかを特定するシナリオを想像してみてください。その後のスイープは、最も重要なハイパーパラメーターに限られるため、より良いモデルをより速く、より安価に見つけることができます。

{{% alert %}}
W&B は、線形モデルよりもカテゴリカルデータや正規化されていないデータに対して寛容なツリーベースのモデルを使用して重要度を計算します。
{{% /alert %}}

前の画像では、`epochs, learning_rate, batch_size` および `weight_decay` がかなり重要でした。

### 相関

相関は、個々のハイパーパラメーターとメトリクスの値との間の線形関係を捉えます。ハイパーパラメーター、たとえば SGD オプティマイザー を使用することと `val_loss` との間に有意な関係があるかどうかを確認します（この場合、答えは「はい」です）。相関値は -1 から 1 の範囲で、正の値は正の線形相関を、負の値は負の線形相関を表し、0 の値は相関がないことを表します。一般的に、どちらの方向でも 0.7 を超える値は強い相関を示します。

このグラフを利用して、メトリクスに対する相関が高い値（この場合、確率的勾配降下法や adam を rmsprop や nadam よりも選ぶか、より多くのエポックでトレーニングするかもしれません）をさらに探索することができます。

{{% alert %}}
* 相関は関連性の証拠を示すものであり、因果関係を示すものではありません。
* 相関は外れ値に敏感であり、ハイパーパラメーターのサンプルサイズが小さい場合、強い関係を中程度の関係に変えるかもしれません。
* 最後に、相関はハイパーパラメーターとメトリクスとの間の線形関係のみを捉えます。もし強い多項式関係がある場合、相関では捉えることができません。
{{% /alert %}}

重要性と相関の違いは、重要性はハイパーパラメーター間の相互作用を考慮したものであり、相関は個々のハイパーパラメーターがメトリクスに与える影響のみを測定するために生じます。第二に、相関は線形関係のみを捉える一方で、重要性はより複雑な関係を捉えることができます。

ご覧のとおり、重要性も相関も、あなたのハイパーパラメーターがモデルパフォーマンスにどのように影響するかを理解するための強力なツールです。